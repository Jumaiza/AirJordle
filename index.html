<html>

<head>

	<title>Air Jordle Game</title>
	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">
	<style>
	
		body { background: rgb(219, 217, 214); }

		* { margin: 0; padding: 0; font-family: 'Roboto Slab', serif; }

		.dd-vc { position: relative; top: 50%; transform: translateY(-50%); }
		.dd-transition { transition: all 0.3s ease; }
		.dd-shadow { box-shadow: 0 0 3px 1px rgba(0,0,0,0.3); }

		#dragDrop { width: 1400px; margin: 10px auto 0; position: relative;}
		#submitButton {background-color: rgb(214, 39, 39); font-size: 25px; width: 20%; height: 5%; position: absolute; bottom: 7.5%; left: 40%;
			cursor: pointer; box-shadow: 0 0 3px 1px rgba(0,0,0,0.7);
			opacity: 0.8;
		}
		#submitButton:hover{
			opacity: 1;
		}
		#attemptsLeft{ position: absolute; bottom: 4%; right: 46.5%;}

		.dd-slot { float: left; outline: 3px dashed rgba(204, 49, 49, 0.75); outline-offset: -15px; position: relative; pointer-events: none; }
		.dd-slot-num { text-align: center; color: rgba(0,0,0,0.3); font-size: 40px; position: absolute; width: 100%; }

		.dd-item { position: absolute; left: 0; top: 0; box-sizing: border-box; padding: 10px; cursor: pointer;}
        .dd-item.dd-disabled { pointer-events: none; opacity: 0; }
        .dd-item.dd-selected { z-index: 20; }

		.dd-item-inner { background:#ffff;background-repeat: no-repeat; background-size: 85%; background-position: center; width: 100%; height: 100%; position: relative; }
		.dd-item-correct{ outline: 4px solid green; outline-offset: -10px; border-radius: 10px;}
		.dd-item-incorrect{outline: 4px solid red; outline-offset: -10px; border-radius: 10px;}

		.dd-item-panel { width: 50%; height: 35px; background: rgb(199, 199, 199); position: absolute; left: 25%; bottom: -25px; z-index: 5; outline: 1px solid rgb(134, 132, 132);}
		.dd-item-title { font-size: 15px; color: black; text-align: center; line-height: 35px; }

	</style>

</head>

<body>
    
    <h1 style="text-align: center; margin-top: 20px; color: black;">Welcome to Air Jordle!</h1>
    <h2 style="text-align: center;"> These Air Jordans are shuffled. Order them from 1-12 to win. You have 3 tries!</h2>
	<h3 style="text-align: center; color: rgba(223, 35, 35, 0.75)"> Developed By Zaid Abujumaiza</h3>
	<div id="dragDrop"></div>
	<input id="submitButton" type="submit" value="Guess">
	<h3 id="attemptsLeft">3 Attempts Left!</h3>

	<script>
	
		(function () {

			var _doc = window.document;

			var _numOfImageSlots = 12,
					_numOfImagesPerRow = 4,
					_imageMarginBottom = 30;

			var _imageAspectWidth = 1920,
					_imageAspectHeight = 1080;

			var _imageSlots = [],
					_selectedImageElement = null,
					_originalImageSlot = null,
					_originalClickCoords = null,
					_lastTouchedSlotId = null;

			var _imageLibrary = [
            { id: 1, image: '/1-12/jordan1.png', title: 'Air Jordan 1' },
				{ id: 2, image: '/1-12/jordan2.png', title: 'Air Jordan 2' },
				{ id: 3, image: '/1-12/jordan3.png', title: 'Air Jordan 3' },
				{ id: 4, image: '/1-12/jordan4.png', title: 'Air Jordan 4' },
				{ id: 5, image: '/1-12/jordan5.png', title: 'Air Jordan 5' },
				{ id: 6, image: '/1-12/jordan6.png', title: 'Air Jordan 6' },
				{ id: 7, image: '/1-12/jordan7.png', title: 'Air Jordan 7' },
				{ id: 8, image: '/1-12/jordan8.png', title: 'Air Jordan 8' },
				{ id: 9, image: '/1-12/jordan9.png', title: 'Air Jordan 9' },
				{ id: 10, image: '/1-12/jordan10.png', title: 'Air Jordan 10' },
				{ id: 11, image: '/1-12/jordan11.png', title: 'Air Jordan 11' },
				{ id: 12, image: '/1-12/jordan12.png', title: 'Air Jordan 12' }],
						_listedImageIds = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];

            function shuffle(array) {
                let currentIndex = array.length,
                    randomIndex;

                while (currentIndex != 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;

                    [array[currentIndex], array[randomIndex]] = [
                        array[randomIndex],
                        array[currentIndex],
                    ];
                }

                return array;
            }

            shuffle(_listedImageIds);

			function init () {

				addImageSlots();
				drawImages();

				_doc.getElementById('dragDrop').addEventListener('mousemove', imageMousemove);
				
				checkGuess();

			}

			var attempts=3;
			function checkGuess() {

					var guessButton = _doc.getElementById("submitButton");
					guessButton.addEventListener("click",function(){

					var numCorrect=0;

					attempts--;
					_doc.getElementById('attemptsLeft').innerHTML=attempts+" Attempts Left!";
						
					var i = 0;
					var len = _listedImageIds.length;

					for (; i<len;i++){

						currentShoe = _listedImageIds[i];
						slotOfShoe = getIndexOfImageId(currentShoe)+1;
						element = _doc.querySelector('[data-image-id="' + currentShoe + '"]');

						if(currentShoe==slotOfShoe){
							element.classList.remove('dd-item-incorrect');
							element.classList.add('dd-item-correct');
							title=_doc.getElementById('title'+currentShoe);
							title.innerHTML="Air Jordan "+currentShoe;
							numCorrect++;
						}else{
							element.classList.add('dd-item-incorrect');
						}
					}

					if(numCorrect==12){
						guessButton.disabled = true;
						if (confirm("Congrats on winning. Press OK or Refresh to play again!")) {
							window.location.reload();
						} 
					}
					else if(attempts==0 ){

						guessButton.disabled=true;

						var i = 0,
							len = _listedImageIds.length;

						for (; i<len;i++){

							currentShoe = _listedImageIds[i];
							title=_doc.getElementById('title'+currentShoe);
							title.innerHTML="Air Jordan "+currentShoe;
						}

						if (confirm("You ran out of attempts. Press OK or Refresh to try again!")) {
							window.location.reload();
						} 
					}

					console.log(attempts);

				});

				}


			function addImageSlots () {

				var i = 0,
						len = _numOfImageSlots,
						item;

				var wrap = _doc.getElementById('dragDrop');

				for ( ; i < len; i++ ) {

					item = _doc.createElement('div');

					item.setAttribute('class', 'dd-slot');
                    item.setAttribute('slot-number',(i+1));
					item.setAttribute('style', 'width:' + ( 100 / _numOfImagesPerRow ) + '%;padding-bottom:' + ( ( 100 / _numOfImagesPerRow ) * ( _imageAspectHeight / _imageAspectWidth ) ) + '%;margin-bottom:' + _imageMarginBottom + 'px;');

					item.innerHTML = '<p class="dd-slot-num dd-vc">Air Jordan ' + ( i + 1 ) + '</p>';

					wrap.appendChild(item);

				}

			}

			function drawImages () {

				var i = 0,
						len = _numOfImageSlots,
						item;

				var wrap = _doc.getElementById('dragDrop');

				var slot = _doc.getElementsByClassName('dd-slot')[0],
						bounds = slot.getBoundingClientRect(),
						itemWidth = bounds.width,
						itemHeight = bounds.height;

				var itemX,
						itemY;

				var imageId,
						image;

				for ( ; i < len; i++ ) {

					imageId = _listedImageIds[i] || -1;
					image = getImageById( imageId );

					itemX = ( i % _numOfImagesPerRow ) * itemWidth;
					itemY = Math.floor( i / _numOfImagesPerRow ) * ( itemHeight + _imageMarginBottom );

					item = _doc.createElement('div');

					item.setAttribute('class', 'dd-item dd-transition' + ( imageId < 0 ? ' dd-disabled' : '' ));
					item.setAttribute('data-image-id', imageId);
					item.setAttribute('style', 'width:' + itemWidth + 'px;height:' + itemHeight + 'px;transform:translate3d(' + itemX + 'px,' + itemY + 'px,0);' );

					item.innerHTML = '<div class="dd-item-inner dd-shadow" style="' + ( image ? ( 'background-image:url(' + image.image + ')' ) : '' ) + '"><div class="dd-item-panel dd-shadow"><h3 class="dd-item-title" id=title'+(imageId)+'>Air Jordan ??</h3></div></div>';

					wrap.appendChild(item);

					item.addEventListener('mousedown', imageMousedown);
					item.addEventListener('mouseup', imageMouseup);

					_imageSlots[i] = { width: itemWidth, height: itemHeight, x: itemX, y: itemY };

				}

			}
			function arrangeItems () {

				var i = 0,
						len = _listedImageIds.length,
						slot,
						ele;

				for ( ; i < len; i++ ) {

					slot = _imageSlots[i];
					ele = _doc.querySelector('[data-image-id="' + _listedImageIds[i] + '"]');

					ele.style.transform = 'translate3d(' + slot.x + 'px,' + slot.y + 'px,0)';

				}

			}

			function imageMousedown ( event ) {

				if ( !_selectedImageElement ) {

					_selectedImageElement = event.currentTarget;
					_originalClickCoords = { x: event.pageX, y: event.pageY };
					_originalImageSlot = getIndexOfImageId( _selectedImageElement.getAttribute('data-image-id') );

					_selectedImageElement.classList.add('dd-selected');
					_selectedImageElement.classList.remove('dd-transition');

				}

			}

			function imageMousemove ( event ) {

				if ( _selectedImageElement ) {

					var wrap = _doc.getElementById('dragDrop'),
							bounds = wrap.getBoundingClientRect(),
							left = bounds.left,
							top = bounds.top;

					var pageX = event.pageX,
							pageY = event.pageY;

					var clickX = pageX - left,
							clickY = pageY - top,
							hoverSlotId = getSlotIdByCoords( { x: clickX, y: clickY } );

					var ele = _selectedImageElement,
							imageId = ele.getAttribute('data-image-id'),
							index = _originalImageSlot,
							newIndex = getIndexOfImageId( imageId ),
							x = _imageSlots[index].x,
							y = _imageSlots[index].y;

					var resultX = x + ( pageX - _originalClickCoords.x ),
							resultY = y + ( pageY - _originalClickCoords.y );

					if ( hoverSlotId != undefined && _lastTouchedSlotId != hoverSlotId ) {

						_lastTouchedSlotId = hoverSlotId;

						_listedImageIds.splice( hoverSlotId, 0, _listedImageIds.splice( newIndex, 1 )[0] );
						arrangeItems();

					}

					ele.style.transform = 'translate3d(' + resultX + 'px,' + resultY + 'px,0)';

				}

			}
			function imageMouseup () {

				_selectedImageElement.classList.remove('dd-selected');
				_selectedImageElement.classList.add('dd-transition');

				_selectedImageElement = null;
				_originalClickCoords = null;

				arrangeItems();

			}

			function getSlotIdByCoords ( coords ) {
		
				// Get the current slot being hovered over
				for ( var id in _imageSlots ) {

					var slot = _imageSlots[id];

					if ( slot.x <= coords.x && coords.x <= slot.x + slot.width && slot.y <= coords.y && coords.y <= slot.y + slot.height )
						return id;

				}

			}
			function getImageById ( id ) {

				return _imageLibrary.find(function (image) {
					return image.id == id;
				});

			}
			function getIndexOfImageId ( id ) {
		
				var i = 0,
						len = _listedImageIds.length;

				for ( ; i < len; i++ )
					if ( _listedImageIds[i] == id )
						return i;

			}

			init();

		})();

	</script>

</body>

</html>